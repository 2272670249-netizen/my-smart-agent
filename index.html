<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的Coze智能体</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        #status { color: #d63384; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>欢迎使用我的智能体</h1>
    <p id="status">正在加载Coze SDK...</p>

    <script>
        // 配置多个可用的SDK源，按顺序尝试加载
        const sdkSources = [
            'https://lf-cdn.coze.com/obj/unpkg/flow-platform/chat-app-sdk/1.1.0/libs/cn/index.js', // 首选
            'https://static.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.1.0/libs/cn/index.js',  // 备选1
            'https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.1.0/libs/cn/index.js'    // 备选2
        ];

        let currentSourceIndex = 0;
        const statusEl = document.getElementById('status');

        function loadSDK(sourceIndex) {
            if (sourceIndex >= sdkSources.length) {
                statusEl.textContent = '错误：所有SDK源均加载失败，请检查网络连接或稍后重试。';
                return;
            }

            const script = document.createElement('script');
            script.src = sdkSources[sourceIndex];
            
            script.onload = function() {
                statusEl.textContent = 'SDK加载成功，正在初始化...';
                initializeCozeBot();
            };
            
            script.onerror = function() {
                statusEl.textContent = `尝试源 ${sourceIndex + 1} 失败，尝试下一个...`;
                currentSourceIndex++;
                loadSDK(currentSourceIndex);
            };
            
            document.head.appendChild(script);
        }

        function initializeCozeBot() {
            if (typeof CozeWebSDK === 'undefined') {
                statusEl.textContent = '错误：CozeWebSDK 对象未定义。';
                return;
            }

            try {
                new CozeWebSDK.WebChatClient({
                    config: {
                        bot_id: '7578063729297145899' // 务必替换为您的真实智能体ID
                    },
                    auth: {
                        type: 'token',
                        token: 'pat_iqDSBzSYUIOn9Crgna838VghoALGsD34HzAICrsZ3X5mL4dJ8ofsFxmWCYmqaqxX' // 务必替换为您的真实访问令牌
                    },
                    userInfo: {
                        id: 'guest_user_' + Date.now(),
                        nickname: '网站访客'
                    }
                });
                
                statusEl.textContent = '加载完成！请点击右下角图标开始聊天。';
                statusEl.style.color = 'green';
                
            } catch (error) {
                statusEl.textContent = '初始化失败: ' + error.message;
            }
        }

        // 开始加载流程
        loadSDK(currentSourceIndex);
    </script>
</body>
</html>
